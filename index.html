<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Identity Threat Hunter (ITH)</title>
  <meta name="description" content="Identity Threat Hunter (ITH) – AI‑enriched identity security analytics on Google Cloud Run + Elastic Security."/>
  <meta name="theme-color" content="#4285F4"/>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; line-height: 1.5; color: #333; }
    .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
    
    /* Header */
    .site-header { background: #1a73e8; color: white; padding: 15px 0; position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .header-inner { display: flex; justify-content: space-between; align-items: center; }
    .brand { font-size: 20px; font-weight: 600; }
    .muted { opacity: 0.7; font-weight: 400; }
    .nav { display: flex; gap: 20px; }
    .nav a { color: white; text-decoration: none; font-size: 14px; }
    .nav a:hover { text-decoration: underline; }
    
    /* Hero */
    .hero { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 50px 0; text-align: center; }
    .hero h1 { font-size: 42px; margin-bottom: 15px; }
    .lead { font-size: 18px; margin-bottom: 25px; opacity: 0.95; }
    .cta { display: flex; gap: 12px; justify-content: center; }
    .btn { padding: 12px 24px; border-radius: 6px; text-decoration: none; font-weight: 500; display: inline-block; transition: all 0.2s; }
    .btn.primary { background: white; color: #667eea; }
    .btn.primary:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.2); }
    .btn:not(.primary) { background: rgba(255,255,255,0.2); color: white; border: 1px solid rgba(255,255,255,0.3); }
    .btn.small { padding: 8px 16px; font-size: 14px; }
    
    /* Sections */
    .section { padding: 40px 0; }
    .section.alt { background: #f8f9fa; }
    .section h2 { font-size: 32px; margin-bottom: 20px; color: #1a73e8; }
    .section p { margin-bottom: 12px; }
    
    /* Grid */
    .grid-2 { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; margin-top: 20px; }
    
    /* Cards */
    .card { background: white; padding: 25px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
    .card h3 { font-size: 22px; margin-bottom: 12px; color: #333; }
    
    /* Lists */
    ul.check, ul.dash, ol.num { margin: 15px 0; padding-left: 20px; }
    ul.check li, ul.dash li, ol.num li { margin-bottom: 8px; }
    ul.check li::marker { content: "✓ "; color: #34a853; }
    ul.dash li::marker { content: "• "; }
    .doclist { list-style: none; padding: 0; }
    .doclist li { margin-bottom: 8px; }
    .doclist a { color: #1a73e8; text-decoration: none; }
    .doclist a:hover { text-decoration: underline; }
    
    /* Rules Grid */
    .rules-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; margin-top: 20px; }
    .rule-card { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.08); border-left: 4px solid #1a73e8; }
    .rule-title { font-weight: 600; font-size: 16px; margin-bottom: 6px; }
    .rule-severity { font-size: 13px; color: #ea4335; margin-bottom: 8px; }
    .rule-desc { font-size: 14px; color: #666; margin: 0; }
    
    /* ASCII */
    .ascii { background: #f5f5f5; padding: 20px; border-radius: 6px; overflow-x: auto; font-family: 'Courier New', monospace; font-size: 13px; line-height: 1.4; margin: 15px 0; }
    
    /* Credentials */
    .creds { background: #f8f9fa; padding: 15px; border-radius: 6px; margin-top: 12px; }
    .creds div { margin-bottom: 6px; font-family: monospace; font-size: 14px; }
    .creds div:last-child { margin-bottom: 0; }
    
    /* Footer */
    .site-footer { background: #333; color: white; padding: 25px 0; margin-top: 40px; }
    .footer-inner { display: flex; justify-content: space-between; align-items: center; }
    
    /* Code */
    code { background: #f5f5f5; padding: 2px 6px; border-radius: 3px; font-family: 'Courier New', monospace; font-size: 13px; }
    
    /* Embedded Rules Section */
    #full-catalog p { margin: 10px 0; line-height: 1.5; }
    #full-catalog strong { font-weight: 600; color: #1a73e8; }
    
    /* Responsive */
    @media (max-width: 768px) {
      .hero h1 { font-size: 32px; }
      .lead { font-size: 16px; }
      .header-inner { flex-direction: column; gap: 10px; }
      .nav { flex-wrap: wrap; justify-content: center; }
      .footer-inner { flex-direction: column; gap: 8px; text-align: center; }
      .cta { flex-direction: column; }
    }
  </style>
</head>
<body>
<header class="site-header">
  <div class="container header-inner">
    <div class="brand">Identity Threat Hunter <span class="muted">(ITH)</span></div>
    <nav class="nav">
      <a href="#overview">Overview</a>
      <a href="#ai">AI Module</a>
      <a href="#synergy">GCP + Elastic</a>
      <a href="#rules">Detections</a>
      <a href="#demo">Live Demo</a>
      <a href="#docs">Docs</a>
    </nav>
  </div>
</header>

<section class="hero">
  <div class="container">
    <h1>Identity Threat Hunter</h1>
    <p class="lead">Cloud‑native identity analytics with <strong>Vertex AI</strong> enrichment on <strong>Google Cloud Run</strong> and <strong>Elastic Security</strong>.</p>
    <div class="cta">
      <a class="btn primary" href="https://ith-ui-1054075376433.us-central1.run.app" target="_blank" rel="noopener">Open Analyst UI</a>
      <a class="btn" href="https://github.com/koushik2296/identity-threat-hunter" target="_blank" rel="noopener">View Source</a>
    </div>
  </div>
</section>

<section class="section" id="overview">
  <div class="container">
    <h2>Overview</h2>
    <p>Identity Threat Hunter (ITH) is an end-to-end, cloud-native platform for detecting, analyzing, and explaining identity-driven threats. It simulates diverse authentication scenarios—such as credential stuffing, MFA fatigue, and honey-identity triggers—and ingests them into <strong>Elastic Security</strong> through a serverless pipeline on <strong>Google Cloud Run</strong>. Alerts are enriched in real time by <strong>Vertex AI</strong>, which generates human-readable <code>ai.summary</code>, behavioral <code>ai.signals</code>, and risk <code>ai.confidence</code> metrics for every detection.</p>
    <p>Designed for enterprise scale, ITH connects the strengths of AI analytics with Elastic's detection engine to provide transparent, explainable identity intelligence. It supports rapid triage, security automation, and SOC enablement—all with synthetic, privacy-safe data for demonstration and benchmarking.</p>
    <ul class="check">
      <li>AI-generated summaries (<code>ai.summary</code>), signals (<code>ai.signals</code>), and confidence (<code>ai.confidence</code>) per alert</li>
      <li>Full Elastic integration with rules, risk scores, and timeline view</li>
      <li>Cloud-run microservices: Event Generator, Ingestor, Analyst UI, Quantum Guardian</li>
      <li>Safe synthetic data for demos—no production or PII exposure</li>
      <li>Judge-ready interactive dashboards and one-click burst simulations</li>
    </ul>
  </div>
</section>

<section class="section" id="architecture">
  <div class="container">
    <h2>Architecture</h2>
    <pre class="ascii">
[User/Judge] → ith-ui (Cloud Run, Analyst UI)
                  │
                  ├→ ith-event-gen → ith-ingestor ──► Elastic (ith-events*)
                  │                       │
                  │                       └─► Vertex AI (Gemini) ⇢ ai.summary / ai.confidence / event.scenario
                  │
                  ├→ quantum-guardian ──► Elastic (quantum-guardian*)
                  │
                  └→ Kibana Alerts (Elastic Security)</pre>
  </div>
</section>

<section class="section alt" id="ai">
  <div class="container">
    <div class="grid-2">
      <div class="card">
        <h3>AI Module (Vertex AI Enrichment)</h3>
        <p>Each incoming event is enriched by <strong>Vertex AI</strong> (Gemini) before indexing to Elastic. The model adds:</p>
        <ul class="dash">
          <li><code>ai.summary</code> — natural‑language explanation of the risk</li>
          <li><code>ai.confidence</code> — 0‑1 score for the explanation</li>
          <li><code>event.scenario</code> — AI‑assisted classification (e.g., <em>impossible_travel</em>)</li>
          <li><code>rule.explanation</code> — appears on Elastic alerts for judge clarity</li>
        </ul>
        <p class="muted">Compliance: Only <strong>Google Cloud AI</strong> tools are used to satisfy hackathon rules.</p>
      </div>
      <div class="card">
        <h3>How to Verify (in Kibana)</h3>
        <ol class="num">
          <li>Open <em>Security → Alerts</em> and click any ITH alert.</li>
          <li>Check <code>rule.explanation</code> for AI‑generated context.</li>
          <li>Open <em>Discover</em> on <code>ith-events*</code> and filter <code>ai.enriched:true</code>.</li>
          <li>Confirm presence of <code>ai.summary</code> and <code>ai.confidence</code>.</li>
        </ol>
      </div>
    </div>
  </div>
</section>

<section class="section" id="synergy">
  <div class="container">
    <div class="grid-2">
      <div class="card">
        <h3>Google Cloud</h3>
        <p>Cloud Run hosts stateless microservices (UI, ingestor, event‑gen, add‑ons). CI/CD via Cloud Build.</p>
        <ul class="dash">
          <li>Serverless containers</li>
          <li>Public demo endpoints</li>
          <li>Logs in Cloud Logging</li>
        </ul>
      </div>
      <div class="card">
        <h3>Elastic Security</h3>
        <p>Elastic Cloud stores events, runs detection rules, and visualizes alerts.</p>
        <ul class="dash">
          <li>Fast indexing and search</li>
          <li>KQL rules and timelines</li>
          <li>Alert details include AI explanations</li>
        </ul>
      </div>
    </div>
  </div>
</section>

<section class="section" id="rules">
  <div class="container">
    <h2>Detection Rule Catalog</h2>
    <div class="rules-grid">
      <div class="rule-card"><div class="rule-title">ITH – Rare Country Login</div><div class="rule-severity">Severity: Medium</div><p class="rule-desc">Detects logins originating from unusual or first‑seen countries.</p></div>
      <div class="rule-card"><div class="rule-title">ITH – Privilege Escalation</div><div class="rule-severity">Severity: High</div><p class="rule-desc">Detects post‑login privilege or role elevation events.</p></div>
      <div class="rule-card"><div class="rule-title">ITH – ASN / ISP Change</div><div class="rule-severity">Severity: High</div><p class="rule-desc">Detects provider changes between sessions indicating anonymization.</p></div>
      <div class="rule-card"><div class="rule-title">ITH – MFA Bypass</div><div class="rule-severity">Severity: High</div><p class="rule-desc">Detects successful authentications that appear to bypass expected MFA.</p></div>
      <div class="rule-card"><div class="rule-title">ITH – Credential Stuffing</div><div class="rule-severity">Severity: High</div><p class="rule-desc">Detects many login attempts across multiple accounts from a single source.</p></div>
      <div class="rule-card"><div class="rule-title">ITH – Brute Force Then Success</div><div class="rule-severity">Severity: High</div><p class="rule-desc">Multiple failures followed by a success from the same source.</p></div>
      <div class="rule-card"><div class="rule-title">ITH – Impossible Travel</div><div class="rule-severity">Severity: Critical</div><p class="rule-desc">Logins from distant locations within a short time window.</p></div>
      <div class="rule-card"><div class="rule-title">ITH Honey‑Identity Trap</div><div class="rule-severity">Severity: Critical</div><p class="rule-desc">Decoy identity (canary) interaction.</p></div>
      <div class="rule-card"><div class="rule-title">ITH – Quantum Adaptive Response</div><div class="rule-severity">Severity: Medium</div><p class="rule-desc">Auto‑investigation when high risk is detected.</p></div>
      <div class="rule-card"><div class="rule-title">ITH – Quantum Guardian High‑Risk</div><div class="rule-severity">Severity: High</div><p class="rule-desc">QES ≥ 70 findings from Quantum Guardian.</p></div>
    </div>
  </div>
</section>

<section class="section alt" id="demo">
  <div class="container">
    <div class="grid-2">
      <div>
        <h2>Live Demo</h2>
        <p>Use the hosted Analyst UI to trigger scenarios. Alerts will appear in Kibana within ~1 minute when rules are enabled.</p>
        <ul class="dash">
          <li>Analyst UI: <a href="https://ith-ui-1054075376433.us-central1.run.app" target="_blank" rel="noopener">Open</a></li>
        </ul>
      </div>
      <div class="card">
        <h3>Judge Login</h3>
        <p>Elastic Security (default space):</p>
        <p><a class="btn small" href="https://4e09aacaaf5546ea985fe43d16a0a09d.us-central1.gcp.cloud.es.io/app/security/alerts" target="_blank" rel="noopener">Open Kibana Alerts</a></p>
        <div class="creds">
          <div><strong>Username:</strong> <code>ith_judge</code></div>
          <div><strong>Password:</strong> <code>Hackathon2025</code></div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section" id="docs">
  <div class="container">
    <div class="grid-2">
      <div>
        <h2>Documentation</h2>
        <ul class="doclist">
          <li><a href="https://github.com/koushik2296/identity-threat-hunter/blob/main/README.md" target="_blank" rel="noopener">README</a></li>
          <li><a href="https://github.com/koushik2296/identity-threat-hunter/blob/main/README_RUNBOOK.md" target="_blank" rel="noopener">Runbook</a></li>
          <li><a href="https://github.com/koushik2296/identity-threat-hunter/blob/main/INSTRUCTIONS_FOR_JUDGES.md" target="_blank" rel="noopener">Instructions for Judges</a></li>
        </ul>
      </div>
      <div class="card">
        <h3>Repository</h3>
        <p>Open‑source on GitHub with permissive Apache‑2.0 license.</p>
        <p><a class="btn small" href="https://github.com/koushik2296/identity-threat-hunter" target="_blank" rel="noopener">Browse Repository</a></p>
      </div>
    </div>
  </div>
</section>

<section class="section" id="full-catalog">
  <div class="container">
    <h2>Embedded Rules</h2>
    <p><strong>Ingest External Alerts (ITH):</strong> Detects suspicious identity behavior via frequency, sequence, and context correlation to reduce false positives.</p>
    <p><strong>ITH - First Seen Admin Tool on Host:</strong> Flags the first observed execution of selected admin tools per host in ITH indices.</p>
    <p><strong>ITH - Possible Brute-Force (source.ip + user.name):</strong> Counts failed authentications per source.ip and user.name over the interval in ITH indices.</p>
    <p><strong>ITH - Quantum Guardian High-Risk Finding:</strong> Surfaces high/critical Quantum Guardian findings or risk_score >= 70.</p>
    <p><strong>ITH - VSS Deleted via vssadmin:</strong> Detects deletion of Volume Shadow Copies via vssadmin delete shadows in ITH indices.</p>
    <p><strong>ITH Alert Webhook:</strong> Detects suspicious identity behavior via frequency, sequence, and context correlation to reduce false positives.</p>
    <p><strong>ITH Canary User Login Attempt (Failure):</strong> Detects canary user login attempts that failed.</p>
    <p><strong>ITH Canary Username Touched:</strong> Any event involving a canary user (user.name starts with canary-).</p>
    <p><strong>ITH High Risk Score (>= 90):</strong> Detects suspicious identity behavior via frequency, sequence, and context correlation to reduce false positives.</p>
    <p><strong>ITH Honey Token Used:</strong> Triggers when a planted honey token value is observed, indicating secrets misuse or credential exfiltration.</p>
    <p><strong>ITH Honey-Identity Trap Detection:</strong> Detects honeypot/canary events from Identity Threat Hunter.</p>
    <p><strong>ITH Impossible Travel:</strong> Detects geovelocity anomalies: same user logging in from distant locations too quickly to be human.</p>
    <p><strong>ITH Suspicious Test IP Ranges (Demo):</strong> Matches RFC5737 example IPs used in demo honey events.</p>
    <p><strong>ITH – AI Enriched Login:</strong> Detects suspicious identity behavior via frequency, sequence, and context correlation to reduce false positives.</p>
    <p><strong>ITH – All Scenarios (Judge Demo):</strong> ITH baseline detection: ITH – All Scenarios (Judge Demo)</p>
    <p><strong>ITH – ASN / ISP Change:</strong> Highlights back‑to‑back logins for the same user from different ASNs/ISPs, suggesting proxy use or takeover.</p>
    <p><strong>ITH – Brute Force Then Success:</strong> ITH baseline detection: ITH – Brute Force Then Success</p>
    <p><strong>ITH – Credential Stuffing:</strong> Identifies credential‑stuffing/password‑spray by correlating many failures across accounts from a small IP pool.</p>
    <p><strong>ITH – Impossible Travel:</strong> ITH baseline detection: ITH – Impossible Travel</p>
    <p><strong>ITH – Impossible Travel (Custom, with Response Actions):</strong> Custom clone for hackathon demo. Detects impossible travel or high-risk authentication, then automatically runs an OSquery sweep and isolates the host via Elastic Defend.</p>
    <p><strong>ITH – MFA Bypass:</strong> Flags authentications where MFA was bypassed/disabled – strong signal of session hijack or policy misuse.</p>
    <p><strong>ITH – Privilege Escalation:</strong> ITH baseline detection: ITH – Privilege Escalation</p>
    <p><strong>ITH – Quantum Adaptive Response:</strong> Triggers adaptive live OSquery investigation when a high-risk identity event is detected.</p>
    <p><strong>ITH – Rare Country Login:</strong> Detects logins from rare or first‑time countries for the user/tenant – potential compromised credentials.</p>
    <p><strong>ITH – Smoke Test (mfa_bypass):</strong> Flags authentications where MFA was bypassed/disabled – strong signal of session hijack or policy misuse.</p>
    <p><strong>Quantum Guardian – High QES:</strong> Raises alerts on high QES/entropy anomalies correlated with elevated risk indicators.</p>
    <p><strong>Suspicious PowerShell (AutoTriage):</strong> Flags encoded/obfuscated PowerShell execution and script‑block logging indicative of attacker tooling.</p>
  </div>
</section>

<footer class="site-footer">
  <div class="container footer-inner">
    <div>© Identity Threat Hunter (ITH)</div>
    <div class="muted">Built by Koushik Anand and Kruthika Suresh</div>
  </div>
</footer>
</body>
</html>