
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Identity Threat Hunter (ITH)</title>
  <meta name="description" content="Identity Threat Hunter (ITH) — AI‑enriched identity security analytics on Google Cloud Run + Elastic Security."/>
  <meta name="theme-color" content="#4285F4"/>
  <link rel="stylesheet" href="styles.css"/>
</head>
<body>
<header class="site-header">
  <div class="container header-inner">
    <div class="brand">Identity Threat Hunter <span class="muted">(ITH)</span></div>
    <nav class="nav">
      <a href="#overview">Overview</a>
      <a href="#ai">AI Module</a>
      <a href="#synergy">GCP + Elastic</a>
      <a href="#rules">Detections</a>
      <a href="#demo">Live Demo</a>
      <a href="#docs">Docs</a>
    </nav>
  </div>
</header>

<section class="hero">
  <div class="container">
    <h1>Identity Threat Hunter</h1>
    <p class="lead">Cloud‑native identity analytics with <strong>Vertex AI</strong> enrichment on <strong>Google Cloud Run</strong> and <strong>Elastic Security</strong>.</p>
    <div class="cta">
      <a class="btn primary" href="https://ith-ui-1054075376433.us-central1.run.app" target="_blank" rel="noopener">Open Analyst UI</a>
      <a class="btn" href="https://github.com/koushik2296/identity-threat-hunter" target="_blank" rel="noopener">View Source</a>
    </div>
  </div>
</section>

<section class="section" id="overview">
  <div class="container grid-2">
    <div>
      <h2>Overview</h2>
<p><strong>Identity Threat Hunter (ITH)</strong> is a cloud‑native identity security platform that detects, explains, and showcases complex identity attacks in real time. It combines <strong>Google Cloud Run</strong> microservices, <strong>Elastic Security</strong> detections, and <strong>Vertex AI</strong> enrichment to turn raw authentication and behavior signals into analyst‑ready, human‑readable stories with risk, rationale, and recommended response.</p>
<p>ITH was built for a judge‑friendly demo and a practitioner‑ready workflow. You can <em>simulate</em> rich identity traffic (burst mode), <em>detect</em> it with a curated + extended rule pack, <em>enrich</em> findings using AI (summary, reasoning, confidence), and <em>visualize/triage</em> everything in an Analyst UI and Kibana Alerts. The system emphasizes transparency: every alert includes <code>event.scenario</code>, <code>rule.explanation</code>, and AI fields like <code>ai.summary</code>, <code>ai.signals</code>, and <code>ai.confidence</code>.</p>
<ul class="dash">
  <li><strong>What it solves:</strong> Fast, explainable identity threat detection (credential abuse, MFA bypass, geo anomalies, decoy/honey identity touches, etc.).</li>
  <li><strong>How it works:</strong> Ingest → Detect (rules) → Enrich (AI) → Triage (UI/Kibana) → Optional respond.</li>
  <li><strong>Why judges care:</strong> One click to generate realistic alerts; clear narratives; safe demo; clean runbook; extensible beyond the demo.</li>
</ul>


<div class="callouts">
  <div class="callout ai-help">
    <h3>Why AI helps here</h3>
    <p>Vertex AI enriches detections so analysts get the “why” without digging through raw logs.</p>
    <ul class="dash">
      <li><code>ai.summary</code> — a short narrative of what happened and why it matters.</li>
      <li><code>ai.signals</code> — extracted indicators (geo jump, ASN change, failed→success login chain, decoy touch).</li>
      <li><code>ai.confidence</code> — model confidence (0–100); useful for sorting triage queues.</li>
    </ul>
    <p class="muted">Where to view in Kibana: open an alert → <em>Alert details</em> panel → fields tab; add <code>ai.*</code> fields as columns or inspect in the JSON view.</p>
  </div>
  <div class="callout privacy">
    <h3>Security &amp; Privacy</h3>
    <ul class="dash">
      <li><strong>Synthetic-only</strong> traffic for demos; no customer data, no PII.</li>
      <li>Network egress is limited to Elastic and GCP services used by the demo.</li>
      <li>All identities, IPs, and locations used are placeholders (RFC 5737 ranges, test usernames).</li>
    </ul>
  </div>
</div>
<h2>Architecture</h2>
<section class="arch-tier" aria-label="Identity Threat Hunter Architecture">
  <!-- Tier 1: Data flow left → right -->
  <div class="arch-row arch-top">
    <div class="arch-card">
      <h4>Event Generator</h4>
      <p>Credential stuffing, brute‑force→success, impossible travel, ASN change, honey‑identity.</p>
    </div>
    <div class="arch-arrow">→</div>
    <div class="arch-card">
      <h4>Ingestor (Cloud Run)</h4>
      <p>POST <code>/ingest</code> → <code>ith‑events*</code>. Normalize, add metadata.</p>
    </div>
    <div class="arch-arrow">→</div>
    <div class="arch-card">
      <h4>Elastic Detections</h4>
      <p>Baseline + Extended rules. <code>rule.explanation</code>, risk score, tags.</p>
    </div>
  </div>

  <!-- Tier 2: AI + Analyst surfaces -->
  <div class="arch-row arch-bottom">
    <div class="arch-card">
      <h4>AI Enrichment (Vertex AI)</h4>
      <p><code>ai.summary</code>, <code>ai.signals</code>, <code>ai.confidence</code>.</p>
    </div>
    <div class="arch-arrow">↘</div>
    <div class="arch-card wide">
      <h4>Analyst UI (Cloud Run)</h4>
      <p>Judge‑friendly filters, scenarios, trigger tools.</p>
    </div>
    <div class="arch-arrow">↙</div>
    <div class="arch-card wide">
      <h4>Kibana (Elastic Security → Alerts)</h4>
      <p>Filters, timelines, fields; add <code>ai.*</code> as columns.</p>
    </div>
  </div>
</section>

<section class="section alt" id="ai">
  <div class="container grid-2">
    <div class="card">
      <h3>AI Module (Vertex AI Enrichment)</h3>
      <p>Each incoming event is enriched by <strong>Vertex AI</strong> (Gemini) before indexing to Elastic. The model adds:</p>
      <ul class="dash">
        <li><code>ai.summary</code> — natural‑language explanation of the risk</li>
        <li><code>ai.confidence</code> — 0‑1 score for the explanation</li>
        <li><code>event.scenario</code> — AI‑assisted classification (e.g., <em>impossible_travel</em>)</li>
        <li><code>rule.explanation</code> — appears on Elastic alerts for judge clarity</li>
      </ul>
      <p class="muted">Compliance: Only <strong>Google Cloud AI</strong> tools are used to satisfy hackathon rules.</p>
    </div>
    <div class="card">
      <h3>How to Verify (in Kibana)</h3>
      <ol class="num">
        <li>Open <em>Security → Alerts</em> and click any ITH alert.</li>
        <li>Check <code>rule.explanation</code> for AI‑generated context.</li>
        <li>Open <em>Discover</em> on <code>ith-events*</code> and filter <code>ai.enriched:true</code>.</li>
        <li>Confirm presence of <code>ai.summary</code> and <code>ai.confidence</code>.</li>
      </ol>
    </div>
  </div>
</section>

<section class="section" id="synergy">
  <div class="container grid-2">
    <div class="card">
      <h3>Google Cloud</h3>
      <p>Cloud Run hosts stateless microservices (UI, ingestor, event‑gen, add‑ons). CI/CD via Cloud Build.</p>
      <ul class="dash">
        <li>Serverless containers</li>
        <li>Public demo endpoints</li>
        <li>Logs in Cloud Logging</li>
      </ul>
    </div>
    <div class="card">
      <h3>Elastic Security</h3>
      <p>Elastic Cloud stores events, runs detection rules, and visualizes alerts.</p>
      <ul class="dash">
        <li>Fast indexing and search</li>
        <li>KQL rules and timelines</li>
        <li>Alert details include AI explanations</li>
      </ul>
    </div>
  </div>
</section>

<section class="section" id="rules">
  <h2>Detection Rule Catalog</h2>
  <div class="rules-grid">
    <div class="rule-card"><div class="rule-title">ITH – Rare Country Login</div><div class="rule-severity">Severity: Medium</div><p class="rule-desc">Detects logins originating from unusual or first‑seen countries.</p></div>
    <div class="rule-card"><div class="rule-title">ITH – Privilege Escalation</div><div class="rule-severity">Severity: High</div><p class="rule-desc">Detects post‑login privilege or role elevation events.</p></div>
    <div class="rule-card"><div class="rule-title">ITH – ASN / ISP Change</div><div class="rule-severity">Severity: High</div><p class="rule-desc">Detects provider changes between sessions indicating anonymization.</p></div>
    <div class="rule-card"><div class="rule-title">ITH – MFA Bypass</div><div class="rule-severity">Severity: High</div><p class="rule-desc">Detects successful authentications that appear to bypass expected MFA.</p></div>
    <div class="rule-card"><div class="rule-title">ITH – Credential Stuffing</div><div class="rule-severity">Severity: High</div><p class="rule-desc">Detects many login attempts across multiple accounts from a single source.</p></div>
    <div class="rule-card"><div class="rule-title">ITH – Brute Force Then Success</div><div class="rule-severity">Severity: High</div><p class="rule-desc">Multiple failures followed by a success from the same source.</p></div>
    <div class="rule-card"><div class="rule-title">ITH – Impossible Travel</div><div class="rule-severity">Severity: Critical</div><p class="rule-desc">Logins from distant locations within a short time window.</p></div>
    <div class="rule-card"><div class="rule-title">ITH Honey‑Identity Trap</div><div class="rule-severity">Severity: Critical</div><p class="rule-desc">Decoy identity (canary) interaction.</p></div>
    <div class="rule-card"><div class="rule-title">ITH – Quantum Adaptive Response</div><div class="rule-severity">Severity: Medium</div><p class="rule-desc">Auto‑investigation when high risk is detected.</p></div>
    <div class="rule-card"><div class="rule-title">ITH – Quantum Guardian High‑Risk</div><div class="rule-severity">Severity: High</div><p class="rule-desc">QES ≥ 70 findings from Quantum Guardian.</p></div>
  </div>
</section>

<section class="section alt" id="demo">
  <div class="container grid-2">
    <div>
      <h2>Live Demo</h2>
      <p>Use the hosted Analyst UI to trigger scenarios. Alerts will appear in Kibana within ~1 minute when rules are enabled.</p>
      <ul class="dash">
        <li>Analyst UI: <a href="https://ith-ui-1054075376433.us-central1.run.app" target="_blank" rel="noopener">Open</a></li>
      </ul>
    </div>
    <div class="card">
      <h3>Judge Login</h3>
      <p>Elastic Security (default space):</p>
      <p><a class="btn small" href="https://4e09aacaaf5546ea985fe43d16a0a09d.us-central1.gcp.cloud.es.io/app/security/alerts" target="_blank" rel="noopener">Open Kibana Alerts</a></p>
      <div class="creds">
        <div><strong>Username:</strong> <code>ith_judge</code></div>
        <div><strong>Password:</strong> <code>Hackathon2025</code></div>
      </div>
      <p class="muted">Tip: In <em>Discover</em>, filter <code>ai.enriched:true</code> to see AI‑annotated events.</p>
    </div>
  </div>
</section>

<section class="section" id="docs">
  <div class="container grid-2">
    <div>
      <h2>Documentation</h2>
      <ul class="doclist">
        <li><a href="https://github.com/koushik2296/identity-threat-hunter/blob/main/README.md" target="_blank" rel="noopener">README</a></li>
        <li><a href="https://github.com/koushik2296/identity-threat-hunter/blob/main/README_RUNBOOK.md" target="_blank" rel="noopener">Runbook</a></li>
        <li><a href="https://github.com/koushik2296/identity-threat-hunter/blob/main/INSTRUCTIONS_FOR_JUDGES.md" target="_blank" rel="noopener">Instructions for Judges</a></li>
      </ul>
    </div>
    <div class="card">
      <h3>Repository</h3>
      <p>Open‑source on GitHub with permissive Apache‑2.0 license.</p>
      <p><a class="btn small" href="https://github.com/koushik2296/identity-threat-hunter" target="_blank" rel="noopener">Browse Repository</a></p>
    </div>
  </div>
</section>

<footer class="site-footer">
  <div class="container footer-inner">
    <div>© Identity Threat Hunter (ITH)</div>
    <div class="muted">Built by Koushik Anand and Kruthika Suresh</div>
  </div>


<section class="section" id="full-catalog">
  <div class="container">
    <h2>Detection Rule Catalog</h2>
    <p class="muted">Showing <strong>34</strong> rules from the export. Download the full pack: <a class="btn" href="./rules_export.ndjson">rules_export.ndjson</a></p>
    <div class="table-wrap">
      <table class="table">
        <thead><tr><th>Name</th><th>Severity</th><th>Risk</th><th>Type</th><th>Tags</th><th>Definition</th></tr></thead>
        <tbody>
          <tr>
<td>ITH Honey-Identity Trap Detection</td>
<td class="sev">critical</td>
<td>99</td>
<td>query</td>
<td>ith, honey, canary</td>
<td class="col-def">Detects honeypot/canary events from Identity Threat Hunter.</td>
</tr><tr>
<td>ITH Impossible Travel</td>
<td class="sev">critical</td>
<td>99</td>
<td>query</td>
<td>—</td>
<td class="col-def">ITH Impossible Travel</td>
</tr><tr>
<td>ITH Honey Token Used</td>
<td class="sev">critical</td>
<td>98</td>
<td>query</td>
<td>ith, honey, canary</td>
<td class="col-def">Detects canary token usage events.</td>
</tr><tr>
<td>ITH Canary User Login Attempt (Failure)</td>
<td class="sev">critical</td>
<td>97</td>
<td>query</td>
<td>ith, honey, canary</td>
<td class="col-def">Detects canary user login attempts that failed.</td>
</tr><tr>
<td>ITH Canary Username Touched</td>
<td class="sev">critical</td>
<td>95</td>
<td>query</td>
<td>ith, honey, canary</td>
<td class="col-def">Any event involving a canary user (user.name starts with canary-).</td>
</tr><tr>
<td>ITH - VSS Deleted via vssadmin</td>
<td class="sev">critical</td>
<td>85</td>
<td>query</td>
<td>ITH, Ransomware-Precursors, NoConnector</td>
<td class="col-def">Detects deletion of Volume Shadow Copies via vssadmin delete shadows in ITH indices.</td>
</tr><tr>
<td>ITH High Risk Score (&gt;= 90)</td>
<td class="sev">high</td>
<td>90</td>
<td>query</td>
<td>ith, risk</td>
<td class="col-def">Any event with risk.score &gt;= 90.</td>
</tr><tr>
<td>ITH – All Scenarios (Judge Demo)</td>
<td class="sev">high</td>
<td>90</td>
<td>query</td>
<td>ITH, baseline</td>
<td class="col-def">ITH baseline detection: ITH – All Scenarios (Judge Demo)</td>
</tr><tr>
<td>ITH – Impossible Travel (Custom, with Response Actions)</td>
<td class="sev">high</td>
<td>90</td>
<td>query</td>
<td>ITH, Quantum-Response, Demo, Impossible Travel</td>
<td class="col-def">Custom clone for hackathon demo. Detects impossible travel or high-risk authentication, then automatically runs an OSquery sweep and isolates the host via Elastic Defend.</td>
</tr><tr>
<td>ITH – Privilege Escalation</td>
<td class="sev">high</td>
<td>90</td>
<td>query</td>
<td>ITH, baseline</td>
<td class="col-def">ITH baseline detection: ITH – Privilege Escalation</td>
</tr><tr>
<td>ITH – Brute Force Then Success</td>
<td class="sev">high</td>
<td>85</td>
<td>query</td>
<td>ITH, baseline</td>
<td class="col-def">ITH baseline detection: ITH – Brute Force Then Success</td>
</tr><tr>
<td>ITH – Credential Stuffing</td>
<td class="sev">high</td>
<td>85</td>
<td>query</td>
<td>ITH, baseline</td>
<td class="col-def">ITH baseline detection: ITH – Credential Stuffing</td>
</tr><tr>
<td>ITH - Quantum Guardian High-Risk Finding</td>
<td class="sev">high</td>
<td>80</td>
<td>query</td>
<td>ITH, QuantumGuardian, NoConnector</td>
<td class="col-def">Surfaces high/critical Quantum Guardian findings or risk_score &gt;= 70.</td>
</tr><tr>
<td>ITH – Impossible Travel</td>
<td class="sev">high</td>
<td>80</td>
<td>query</td>
<td>ITH, baseline</td>
<td class="col-def">ITH baseline detection: ITH – Impossible Travel</td>
</tr><tr>
<td>ITH – MFA Bypass</td>
<td class="sev">high</td>
<td>80</td>
<td>query</td>
<td>ITH, baseline</td>
<td class="col-def">ITH baseline detection: ITH – MFA Bypass</td>
</tr><tr>
<td>ITH – ASN / ISP Change</td>
<td class="sev">high</td>
<td>73</td>
<td>query</td>
<td>—</td>
<td class="col-def">ITH – ASN / ISP Change</td>
</tr><tr>
<td>ITH – Brute Force Then Success</td>
<td class="sev">high</td>
<td>73</td>
<td>query</td>
<td>—</td>
<td class="col-def">ITH – Brute Force Then Success</td>
</tr><tr>
<td>ITH – Privilege Escalation</td>
<td class="sev">high</td>
<td>73</td>
<td>query</td>
<td>—</td>
<td class="col-def">ITH – Privilege Escalation</td>
</tr><tr>
<td>Suspicious PowerShell (AutoTriage)</td>
<td class="sev">high</td>
<td>73</td>
<td>query</td>
<td>—</td>
<td class="col-def">Suspicious PowerShell (AutoTriage)</td>
</tr><tr>
<td>ITH Suspicious Test IP Ranges (Demo)</td>
<td class="sev">medium</td>
<td>70</td>
<td>query</td>
<td>ith, demo</td>
<td class="col-def">Matches RFC5737 example IPs used in demo honey events.</td>
</tr><tr>
<td>ITH – ASN / ISP Change</td>
<td class="sev">medium</td>
<td>60</td>
<td>query</td>
<td>ITH, baseline</td>
<td class="col-def">ITH baseline detection: ITH – ASN / ISP Change</td>
</tr><tr>
<td>ITH – Rare Country Login</td>
<td class="sev">medium</td>
<td>60</td>
<td>query</td>
<td>ITH, baseline</td>
<td class="col-def">ITH baseline detection: ITH – Rare Country Login</td>
</tr><tr>
<td>ITH - Possible Brute-Force (source.ip + user.name)</td>
<td class="sev">medium</td>
<td>55</td>
<td>threshold</td>
<td>ITH, Auth, NoConnector</td>
<td class="col-def">Counts failed authentications per source.ip and user.name over the interval in ITH indices.</td>
</tr><tr>
<td>ITH - First Seen Admin Tool on Host</td>
<td class="sev">medium</td>
<td>50</td>
<td>new_terms</td>
<td>ITH, Discovery/Lateral, NoConnector</td>
<td class="col-def">Flags the first observed execution of selected admin tools per host in ITH indices.</td>
</tr><tr>
<td>ITH – Quantum Adaptive Response</td>
<td class="sev">low</td>
<td>90</td>
<td>query</td>
<td>—</td>
<td class="col-def">Triggers adaptive live OSquery investigation when a high-risk identity event is detected.</td>
</tr><tr>
<td>Quantum Guardian – High QES</td>
<td class="sev">low</td>
<td>89</td>
<td>query</td>
<td>—</td>
<td class="col-def">Quantum Guardian – High QES</td>
</tr><tr>
<td>ITH – Rare Country Login</td>
<td class="sev">low</td>
<td>81</td>
<td>query</td>
<td>—</td>
<td class="col-def">ITH – Rare Country Login</td>
</tr><tr>
<td>Ingest External Alerts (ITH</td>
<td class="sev">low</td>
<td>53</td>
<td>query</td>
<td>—</td>
<td class="col-def">Ingest External Alerts (ITH</td>
</tr><tr>
<td>ITH – AI Enriched Login</td>
<td class="sev">low</td>
<td>21</td>
<td>query</td>
<td>—</td>
<td class="col-def">ITH – AI Enriched Login</td>
</tr><tr>
<td>ITH – Credential Stuffing</td>
<td class="sev">low</td>
<td>21</td>
<td>query</td>
<td>—</td>
<td class="col-def">ITH – Credential Stuffing</td>
</tr><tr>
<td>ITH – MFA Bypass</td>
<td class="sev">low</td>
<td>21</td>
<td>query</td>
<td>—</td>
<td class="col-def">ITH – MFA Bypass</td>
</tr><tr>
<td>ITH – Smoke Test (mfa_bypass)</td>
<td class="sev">low</td>
<td>21</td>
<td>query</td>
<td>—</td>
<td class="col-def">ITH – Smoke Test (mfa_bypass)</td>
</tr><tr>
<td>ITH Alert Webhook</td>
<td class="sev">—</td>
<td>—</td>
<td>query</td>
<td>—</td>
<td class="col-def">Detects suspicious identity activity per rule logic.</td>
</tr><tr>
<td>Unnamed rule</td>
<td class="sev">—</td>
<td>—</td>
<td>query</td>
<td>—</td>
<td class="col-def">Detects suspicious identity activity per rule logic.</td>
</tr>
        </tbody>
      </table>
    </div>
  </div>
</section>


</footer>
<script src="script.js"></script>
</body>
</html>
